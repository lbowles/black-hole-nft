<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BlackHole SVG</title>
  </head>

  <body>
    <div id="canvasContainer"></div>
    <script>
      const PIXELS_PER_SIDE = 30
      const PIXEL_SIZE = 20
      const CANVAS_SIZE = PIXELS_PER_SIDE * PIXEL_SIZE

      function createQuarterCanvas(size) {
        let circleArray = []
        for (let i = 0; i < PIXELS_PER_SIDE / 2; i++) {
          let row = []
          for (let j = 0; j < PIXELS_PER_SIDE / 2; j++) {
            let x = j - PIXELS_PER_SIDE / 2
            let y = i - PIXELS_PER_SIDE / 2
            let distance = Math.sqrt(x * x + y * y)
            let value = 0
            //Each value represents a differtent color on the grid that is used in createSVG, these create the rings
            switch (true) {
              case distance <= size / 2:
                value = 1
                break
              case distance <= size / 2 + 1:
                value = 2
                break
              case distance <= size / 2 + 2:
                value = 3
                break
              case distance <= size / 2 + 3:
                value = 4
                break
              case distance <= size / 2 + 4:
                value = 5
                break
              case distance <= size / 2 + 6:
                value = 7
                break
              default:
                value = 0
            }
            circleArray.push(value)
          }
        }

        return circleArray
      }

      function createSVG(quarterCanvas) {
        const gridSize = PIXELS_PER_SIDE / 2
        const backgroundColors = [
          "#140E0E",
          "#160F0D",
          "#17120E",
          "#181214",
          "#18130F",
          "#181310",
          "#181410",
          "#1A1210",
          "#1A1511",
          "#1B1310",
          "#1B1517",
          "#282221",
        ]
        const perimiterColors = ["#852C27", "#741D27", "#8F5359", "#D1652C"]
        const blackHoleColors = ["black", "#361902", "#FFD088", "#BD460A", "#390706"]
        //const blackHoleColors = ["black", "#361902", "#234875", "#725BFF", "#102334"]
        let svg = `<svg width="${CANVAS_SIZE}" height="${CANVAS_SIZE}" style="background-color:transparent">`
        let g = `<g id="base">`
        for (let i = 0; i < gridSize; i++) {
          for (let j = 0; j < gridSize; j++) {
            let x = j * PIXEL_SIZE
            let y = i * PIXEL_SIZE
            let randomIndex = Math.floor(Math.random() * 200)
            let fillColor = ""
            const pixelClass = quarterCanvas[i * gridSize + (j % gridSize)]

            if (pixelClass === 0) {
              // Background + small chance of dim star
              fillColor = randomIndex <= 2 ? "#504940" : backgroundColors[(randomIndex - 2) % backgroundColors.length]
            } else if (pixelClass >= 1 && pixelClass <= 6) {
              // Black hole
              fillColor = blackHoleColors[pixelClass - 1]
            } else if (pixelClass === 7) {
              // Perimiter
              if (randomIndex < perimiterColors.length) {
                fillColor = perimiterColors[randomIndex]
              } else {
                fillColor = backgroundColors[Math.floor(randomIndex % backgroundColors.length)]
              }
            }
            g += `<rect x="${x}" y="${y}" width="${PIXEL_SIZE}" height="${PIXEL_SIZE}" fill="${fillColor}"/>`
          }
        }
        g += `</g>`
        svg += g
        svg += `<use href="#base" transform="scale(-1,1),translate(-${CANVAS_SIZE},0)" />`
        svg += `<use href="#base" transform="scale(1,-1),translate(0,-${CANVAS_SIZE})" />`
        svg += `<use href="#base" transform="scale(-1,-1),translate(-${CANVAS_SIZE},-${CANVAS_SIZE})" />`
        svg += `</svg>`
        return svg
      }

      document.getElementById("canvasContainer").innerHTML = ""
      const canvas = document.createElement("div")

      const holeSize = Math.random() * 10 + 4
      canvas.innerHTML = createSVG(createQuarterCanvas(holeSize))
      document.getElementById("canvasContainer").appendChild(canvas)
    </script>
  </body>
</html>
